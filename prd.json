{
  "project": "修仙游戏 - AI Native 架构",
  "branchName": "ralph/immortal-cultivation-game",
  "description": "创建一个基于 AI Native 架构的修仙游戏，使用多个 AI Agent 作为游戏引擎。游戏包含角色创建、升级系统、任务系统、战斗系统、地图系统、技能系统等功能。AI Agent 负责处理对话、任务分配、战斗逻辑、游戏协调等核心功能，提供动态、智能的游戏体验。",
  "userStories": [
    {
      "id": "US-001",
      "title": "协调 Agent - 创建会话",
      "description": "作为游戏引擎，我需要创建协调 Agent 会话，以便管理全局游戏状态和协调其他 Agent。",
      "acceptanceCriteria": [
        "使用 sessions_spawn 创建协调 Agent 会话",
        "定义 Agent 的角色：游戏协调者",
        "定义 Agent 的记忆：全局游戏状态",
        "定义 Agent 的目标：协调所有 agent",
        "Agent 会话正常运行",
        "Typecheck passes"
      ],
      "priority": 1,
      "passes": true,
      "notes": "已完成并测试通过"
    },
    {
      "id": "US-002",
      "title": "游戏状态数据结构定义",
      "description": "作为游戏引擎，我需要定义游戏状态数据结构，以便统一存储和访问游戏数据。",
      "acceptanceCriteria": [
        "定义 gameState 对象，包含字段：player {id, name, class, level, exp, hp, attack, defense, gold}, currentMap, inventory [], skills [], tasks [], equipment {weapon, armor, accessory}",
        "导出 gameState 类型定义供 TypeScript 使用",
        "添加类型注释和文档",
        "Typecheck passes"
      ],
      "priority": 2,
      "passes": true,
      "notes": "已完成并测试通过"
    },
    {
      "id": "US-003",
      "title": "游戏状态初始化",
      "description": "作为游戏引擎，我需要在游戏启动时初始化游戏状态，以便游戏可以正常运行。",
      "acceptanceCriteria": [
        "创建 initGameState() 函数",
        "函数返回初始化的 gameState 对象",
        "玩家信息设置为默认值（level=1, hp=100, gold=0）",
        "当前地图设置为 \"village\"",
        "背包、技能、任务、装备初始化为空数组或对象",
        "Typecheck passes"
      ],
      "priority": 3,
      "passes": true,
      "notes": "已完成并测试通过"
    },
    {
      "id": "US-004",
      "title": "游戏状态更新",
      "description": "作为游戏引擎，我需要更新游戏状态，以便响应玩家的操作和游戏事件。",
      "acceptanceCriteria": [
        "创建 updateGameState() 函数",
        "函数接受参数：gameState, updates (对象）",
        "函数合并 updates 到 gameState",
        "函数返回更新后的 gameState",
        "更新操作是不可变的（不修改原对象）",
        "Typecheck passes"
      ],
      "priority": 4,
      "passes": true,
      "notes": "已完成并测试通过"
    },
    {
      "id": "US-005",
      "title": "游戏状态获取",
      "description": "作为游戏引擎，我需要获取游戏状态，以便前端和其他 Agent 可以访问游戏数据。",
      "acceptanceCriteria": [
        "创建 getGameState() 函数",
        "函数返回当前的 gameState 对象",
        "返回的对象是只读的（防止外部修改）",
        "Typecheck passes"
      ],
      "priority": 5,
      "passes": true,
      "notes": "已完成并测试通过"
    },
    {
      "id": "US-006",
      "title": "Agent 通信格式定义",
      "description": "作为游戏引擎，我需要定义 Agent 之间的通信格式，以便 Agent 可以正确理解彼此的消息。",
      "acceptanceCriteria": [
        "定义消息格式：{ type: string, payload: any, timestamp: string }",
        "定义事件类型常量：PLAYER_MOVE, BATTLE_START, TASK_COMPLETE, PLAYER_CLICK_NPC, PLAYER_ATTACK 等",
        "导出类型定义和常量供其他模块使用",
        "添加类型注释和文档",
        "Typecheck passes"
      ],
      "priority": 6,
      "passes": true,
      "notes": "已完成并测试通过"
    },
    {
      "id": "US-007",
      "title": "消息发送函数",
      "description": "作为协调 Agent，我需要发送消息给其他 Agent，以便进行 Agent 之间的通信。",
      "acceptanceCriteria": [
        "创建 sendMessage() 函数",
        "函数接受参数：targetSessionKey, message (符合消息格式）",
        "函数使用 sessions_send 发送消息",
        "函数返回发送结果（成功/失败）",
        "添加错误处理（目标 Agent 不存在、消息格式错误）",
        "Typecheck passes"
      ],
      "priority": 7,
      "passes": true,
      "notes": "已完成并测试通过"
    },
    {
      "id": "US-008",
      "title": "消息接收函数",
      "description": "作为协调 Agent，我需要接收其他 Agent 发来的消息，以便处理游戏事件和通信。",
      "acceptanceCriteria": [
        "创建 receiveMessage() 函数",
        "函数接受参数：message (符合消息格式）",
        "函数解析消息类型和载荷",
        "函数调用对应的处理函数",
        "添加错误处理（消息格式错误、未知事件类型）",
        "Typecheck passes"
      ],
      "priority": 8,
      "passes": true,
      "notes": "已完成并测试通过"
    },
    {
      "id": "US-009",
      "title": "消息解析函数",
      "description": "作为协调 Agent，我需要解析消息，以便提取事件类型和载荷。",
      "acceptanceCriteria": [
        "创建 parseMessage() 函数",
        "函数接受参数：message (符合消息格式）",
        "函数返回解析结果：{ type, payload, timestamp }",
        "添加消息格式验证",
        "添加错误处理（消息格式错误）",
        "Typecheck passes"
      ],
      "priority": 9,
      "passes": true,
      "notes": "已完成并测试通过"
    },
    {
      "id": "US-010",
      "title": "事件分发函数",
      "description": "作为协调 Agent，我需要分发事件给对应的处理函数，以便处理不同的游戏事件。",
      "acceptanceCriteria": [
        "创建 dispatchEvent() 函数",
        "函数接受参数：eventType, payload",
        "函数查找对应的处理函数",
        "函数调用处理函数并传递 payload",
        "添加错误处理（未知事件类型、处理函数不存在）",
        "Typecheck passes"
      ],
      "priority": 10,
      "passes": true,
      "notes": "已完成并测试通过"
    },
    {
      "id": "US-011",
      "title": "PLAYER_MOVE 事件处理",
      "description": "作为协调 Agent，我需要处理玩家移动事件，以便更新玩家位置。",
      "acceptanceCriteria": [
        "创建 handlePlayerMove() 函数",
        "函数接受参数：{ x, y, direction }",
        "函数更新 gameState 中的玩家位置",
        "函数检查移动是否有效（边界检查）",
        "函数返回更新后的 gameState",
        "Typecheck passes"
      ],
      "priority": 11,
      "passes": true,
      "notes": "已完成并测试通过"
    },
    {
      "id": "US-012",
      "title": "BATTLE_START 事件处理",
      "description": "作为协调 Agent，我需要处理战斗开始事件，以便启动战斗系统。",
      "acceptanceCriteria": [
        "创建 handleBattleStart() 函数",
        "函数接受参数：{ monsterId, monsterType }",
        "函数通知战斗 Agent 开始战斗",
        "函数将游戏状态设置为 \"战斗中\"",
        "函数返回战斗结果（等待战斗 Agent 返回）",
        "Typecheck passes"
      ],
      "priority": 12,
      "passes": true,
      "notes": "已完成并测试通过"
    },
    {
      "id": "US-013",
      "title": "TASK_COMPLETE 事件处理",
      "description": "作为协调 Agent，我需要处理任务完成事件，以便更新任务状态和发放奖励。",
      "acceptanceCriteria": [
        "创建 handleTaskComplete() 函数",
        "函数接受参数：{ taskId }",
        "函数更新 gameState 中的任务状态",
        "函数通知对话&任务&商店 Agent 验证任务",
        "函数接收奖励并更新 gameState",
        "Typecheck passes"
      ],
      "priority": 13,
      "passes": true,
      "notes": "已完成并测试通过"
    },
    {
      "id": "US-014",
      "title": "PLAYER_CLICK_NPC 事件处理",
      "description": "作为协调 Agent，我需要处理玩家点击 NPC 事件，以便启动对话或商店。",
      "acceptanceCriteria": [
        "创建 handlePlayerClickNPC() 函数",
        "函数接受参数：{ npcId }",
        "函数通知对话&任务&商店 Agent 玩家点击了 NPC",
        "函数等待对话&任务&商店 Agent 返回对话内容",
        "函数将对话内容返回给前端",
        "Typecheck passes"
      ],
      "priority": 14,
      "passes": true,
      "notes": "已完成并测试通过"
    },
    {
      "id": "US-015",
      "title": "存档保存函数",
      "description": "作为协调 Agent，我需要保存游戏进度到 localStorage，以便玩家可以保存游戏。",
      "acceptanceCriteria": [
        "创建 saveGame() 函数",
        "函数接受参数：gameState",
        "函数将 gameState 序列化为 JSON",
        "函数将 JSON 字符串保存到 localStorage，键为 \"immortalCultivationGame\"",
        "函数返回保存结果（成功/失败）",
        "添加错误处理（localStorage 已满、JSON 序列化失败）",
        "Typecheck passes"
      ],
      "priority": 15,
      "passes": true,
      "notes": "已完成并测试通过"
    },
    {
      "id": "US-016",
      "title": "存档加载函数",
      "description": "作为协调 Agent，我需要从 localStorage 加载游戏进度，以便玩家可以恢复游戏。",
      "acceptanceCriteria": [
        "创建 loadGame() 函数",
        "函数从 localStorage 读取键为 \"immortalCultivationGame\" 的数据",
        "函数将 JSON 字符串反序列化为 gameState 对象",
        "函数验证存档是否损坏（格式检查）",
        "函数返回加载后的 gameState 或错误信息",
        "添加错误处理（localStorage 不存在、JSON 反序列化失败、存档损坏）",
        "Typecheck passes"
      ],
      "priority": 16,
      "passes": true,
      "notes": "已完成并测试通过"
    },
    {
      "id": "US-017",
      "title": "存档验证函数",
      "description": "作为协调 Agent，我需要验证存档是否损坏，以便确保存档可以正常加载。",
      "acceptanceCriteria": [
        "创建 validateSaveGame() 函数",
        "函数接受参数：gameState (any)",
        "函数检查 gameState 是否包含必需的字段（player, currentMap, inventory 等）",
        "函数检查字段类型是否正确",
        "函数返回验证结果（true/false）和错误信息（如果有）",
        "Typecheck passes"
      ],
      "priority": 17,
      "passes": true,
      "notes": "已完成并测试通过"
    },
    {
      "id": "US-018",
      "title": "初始化函数",
      "description": "作为协调 Agent，我需要提供初始化函数，以便前端可以启动游戏。",
      "acceptanceCriteria": [
        "创建 init() 函数",
        "函数调用 initGameState() 初始化游戏状态",
        "函数检查是否有存档，如果有则加载",
        "函数返回初始化后的 gameState",
        "Typecheck passes"
      ],
      "priority": 18,
      "passes": true,
      "notes": "已完成并测试通过"
    },
    {
      "id": "US-019",
      "title": "事件处理函数",
      "description": "作为协调 Agent，我需要提供事件处理函数，以便前端可以发送游戏事件。",
      "acceptanceCriteria": [
        "创建 handleEvent() 函数",
        "函数接受参数：{ type, payload }",
        "函数调用 dispatchEvent() 分发事件",
        "函数返回事件处理结果",
        "Typecheck passes"
      ],
      "priority": 19,
      "passes": true,
      "notes": "已完成并测试通过"
    },
    {
      "id": "US-020",
      "title": "保存游戏函数（API）",
      "description": "作为协调 Agent，我需要提供保存游戏函数（API），以便前端可以保存游戏进度。",
      "acceptanceCriteria": [
        "创建 saveGameAPI() 函数",
        "函数调用 saveGame() 保存当前游戏状态",
        "函数返回保存结果",
        "Typecheck passes"
      ],
      "priority": 20,
      "passes": true,
      "notes": "已完成并测试通过"
    },
    {
      "id": "US-021",
      "title": "加载游戏函数（API）",
      "description": "作为协调 Agent，我需要提供加载游戏函数（API），以便前端可以加载游戏进度。",
      "acceptanceCriteria": [
        "创建 loadGameAPI() 函数",
        "函数调用 loadGame() 加载游戏进度",
        "函数返回加载后的 gameState",
        "Typecheck passes"
      ],
      "priority": 21,
      "passes": true,
      "notes": "已完成并测试通过"
    },
    {
      "id": "US-022",
      "title": "获取游戏状态函数（API）",
      "description": "作为协调 Agent，我需要提供获取游戏状态函数（API），以便前端可以获取当前游戏状态。",
      "acceptanceCriteria": [
        "创建 getGameStateAPI() 函数",
        "函数调用 getGameState() 获取当前游戏状态",
        "函数返回 gameState",
        "Typecheck passes"
      ],
      "priority": 22,
      "passes": true,
      "notes": "已完成并测试通过"
    },
    {
      "id": "US-023",
      "title": "对话&任务&商店 Agent - 创建会话",
      "description": "作为对话&任务&商店 Agent，我需要创建会话，以便处理 NPC 对话、任务分配、商店交易。",
      "acceptanceCriteria": [
        "使用 sessions_spawn 创建对话&任务&商店 Agent 会话",
        "定义 Agent 的角色：对话、任务、商店管理员",
        "定义 Agent 的记忆：NPC 记忆、玩家历史",
        "定义 Agent 的目标：提供对话、任务、商店功能",
        "Agent 会话正常运行",
        "Typecheck passes"
      ],
      "priority": 23,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-024",
      "title": "村长实现 - 对话功能",
      "description": "作为村长，我需要与玩家进行对话，以便引导玩家开始修仙之路。",
      "acceptanceCriteria": [
        "定义村长的角色：村庄管理者",
        "定义村长的个性：温和、智慧、热心、耐心",
        "定义村长的背景：曾经是修仙者，后来成为村长",
        "实现村长的对话功能（动态生成对话，不使用预设脚本）",
        "村长记住玩家的对话历史",
        "Typecheck passes"
      ],
      "priority": 24,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-025",
      "title": "村长实现 - 任务功能",
      "description": "作为村长，我需要分配任务给玩家，以便玩家可以完成任务并获得奖励。",
      "acceptanceCriteria": [
        "定义村长的能力：分配任务、验证任务完成、发放奖励",
        "实现任务分配功能（击杀任务：击败 5 只狼）",
        "实现任务验证功能（检查玩家是否完成任务）",
        "实现奖励发放功能（金币、经验）",
        "村长记住玩家的任务历史",
        "Typecheck passes"
      ],
      "priority": 25,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-026",
      "title": "铁匠实现 - 对话功能",
      "description": "作为铁匠，我需要与玩家进行对话，以便出售装备和修理装备。",
      "acceptanceCriteria": [
        "定义铁匠的角色：装备商人",
        "定义铁匠的个性：粗犷、直爽、热情",
        "定义铁匠的背景：曾是军中工匠",
        "实现铁匠的对话功能（动态生成对话，不使用预设脚本）",
        "铁匠记住玩家的对话历史",
        "Typecheck passes"
      ],
      "priority": 26,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-027",
      "title": "铁匠实现 - 商店功能",
      "description": "作为铁匠，我需要出售装备和修理装备，以便玩家可以获取更好的装备。",
      "acceptanceCriteria": [
        "定义铁匠的能力：出售装备、修理装备",
        "实现出售装备功能（武器、防具、饰品）",
        "实现修理装备功能（修复装备的耐久度）",
        "实现价格计算（装备价值、修理费用）",
        "铁匠记住玩家的交易历史",
        "Typecheck passes"
      ],
      "priority": 27,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-028",
      "title": "药王实现 - 对话功能",
      "description": "作为药王，我需要与玩家进行对话，以便出售药水和提供治疗建议。",
      "acceptanceCriteria": [
        "定义药王的角色：药水商人",
        "定义药王的个性：温和、神秘、智慧",
        "定义药王的背景：曾是皇家御医",
        "实现药王的对话功能（动态生成对话，不使用预设脚本）",
        "药王记住玩家的对话历史",
        "Typecheck passes"
      ],
      "priority": 28,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-029",
      "title": "药王实现 - 商店功能",
      "description": "作为药王，我需要出售药水，以便玩家可以恢复生命值。",
      "acceptanceCriteria": [
        "定义药王的能力：出售药水、提供治疗建议",
        "实现出售药水功能（生命药水、魔法药水）",
        "实现价格计算（药水价值）",
        "药王记住玩家的交易历史",
        "Typecheck passes"
      ],
      "priority": 29,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-030",
      "title": "仙师实现 - 对话功能",
      "description": "作为仙师，我需要与玩家进行对话，以便传授技能和提供修炼建议。",
      "acceptanceCriteria": [
        "定义仙师的角色：技能传授者",
        "定义仙师的个性：高深莫测、神秘、智慧",
        "定义仙师的背景：曾是仙人下凡",
        "实现仙师的对话功能（动态生成对话，不使用预设脚本）",
        "仙师记住玩家的对话历史",
        "Typecheck passes"
      ],
      "priority": 30,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-031",
      "title": "仙师实现 - 技能功能",
      "description": "作为仙师，我需要传授技能给玩家，以便玩家可以学习新的技能。",
      "acceptanceCriteria": [
        "定义仙师的能力：传授技能、提供修炼建议",
        "实现技能传授功能（消耗金币和技能点）",
        "实现技能等级要求检查",
        "实现修炼建议功能（根据玩家等级和职业）",
        "仙师记住玩家的学习历史",
        "Typecheck passes"
      ],
      "priority": 31,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-032",
      "title": "战斗 Agent - 创建会话",
      "description": "作为战斗 Agent，我需要创建会话，以便处理战斗逻辑和怪物 AI。",
      "acceptanceCriteria": [
        "使用 sessions_spawn 创建战斗 Agent 会话",
        "定义 Agent 的角色：战斗系统",
        "定义 Agent 的记忆：战斗历史",
        "定义 Agent 的目标：管理战斗逻辑",
        "Agent 会话正常运行",
        "Typecheck passes"
      ],
      "priority": 32,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-033",
      "title": "伤害计算函数",
      "description": "作为战斗 Agent，我需要计算伤害，以便确定攻击对目标的影响。",
      "acceptanceCriteria": [
        "创建 calculateDamage() 函数",
        "函数接受参数：attacker, defender",
        "函数计算伤害 = attacker.attack - defender.defense",
        "函数确保伤害最小值为 1",
        "函数返回计算后的伤害值",
        "Typecheck passes"
      ],
      "priority": 33,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-034",
      "title": "战斗状态管理",
      "description": "作为战斗 Agent，我需要管理战斗状态，以便跟踪战斗进度。",
      "acceptanceCriteria": [
        "定义战斗状态类型：idle, fighting, victory, defeat",
        "创建战斗状态变量",
        "实现战斗状态更新函数",
        "实现战斗状态获取函数",
        "Typecheck passes"
      ],
      "priority": 34,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-035",
      "title": "战斗结果处理",
      "description": "作为战斗 Agent，我需要处理战斗结果，以便发放奖励和更新游戏状态。",
      "acceptanceCriteria": [
        "创建 handleBattleResult() 函数",
        "函数接受参数：result (victory/defeat), rewards {gold, exp, items}",
        "函数通知协调 Agent 战斗结束",
        "函数传递奖励给协调 Agent",
        "Typecheck passes"
      ],
      "priority": 35,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-036",
      "title": "战斗日志生成",
      "description": "作为战斗 Agent，我需要生成战斗日志，以便记录战斗过程。",
      "acceptanceCriteria": [
        "创建 generateBattleLog() 函数",
        "函数接受参数：attacker, defender, damage",
        "函数生成战斗日志字符串（例如：\"玩家对狼造成 50 点伤害\"）",
        "函数返回战斗日志字符串",
        "Typecheck passes"
      ],
      "priority": 36,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-037",
      "title": "狼 AI 实现",
      "description": "作为狼，我需要决定攻击策略，以便在战斗中与玩家对抗。",
      "acceptanceCriteria": [
        "定义狼的属性：level=1, hp=50, attack=8, defense=3",
        "定义狼的攻击策略：简单攻击（随机攻击玩家）",
        "实现狼的 AI 决策函数",
        "狼 AI 可以正常决策",
        "Typecheck passes"
      ],
      "priority": 37,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-038",
      "title": "熊 AI 实现",
      "description": "作为熊，我需要决定攻击策略，以便在战斗中与玩家对抗。",
      "acceptanceCriteria": [
        "定义熊的属性：level=2, hp=80, attack=12, defense=5",
        "定义熊的攻击策略：攻击 + 咆哮（降低玩家攻击力）",
        "实现熊的 AI 决策函数",
        "熊 AI 可以正常决策",
        "Typecheck passes"
      ],
      "priority": 38,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-039",
      "title": "骷髅 AI 实现",
      "description": "作为骷髅，我需要决定攻击策略，以便在战斗中与玩家对抗。",
      "acceptanceCriteria": [
        "定义骷髅的属性：level=3, hp=60, attack=10, defense=4",
        "定义骷髅的攻击策略：简单攻击（随机攻击玩家）",
        "实现骷髅的 AI 决策函数",
        "骷髅 AI 可以正常决策",
        "Typecheck passes"
      ],
      "priority": 39,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-040",
      "title": "僵尸 AI 实现",
      "description": "作为僵尸，我需要决定攻击策略，以便在战斗中与玩家对抗。",
      "acceptanceCriteria": [
        "定义僵尸的属性：level=4, hp=100, attack=15, defense=6",
        "定义僵尸的攻击策略：简单攻击（随机攻击玩家）",
        "实现僵尸的 AI 决策函数",
        "僵尸 AI 可以正常决策",
        "Typecheck passes"
      ],
      "priority": 40,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-041",
      "title": "Boss AI 实现",
      "description": "作为 Boss，我需要决定智能攻击策略，以便在战斗中与玩家对抗。",
      "acceptanceCriteria": [
        "定义 Boss 的属性：level=10, hp=500, attack=30, defense=20",
        "定义 Boss 的攻击策略：智能攻击（根据玩家状态选择攻击方式）",
        "实现 Boss 的 AI 决策函数",
        "Boss AI 可以正常决策",
        "Boss AI 攻击策略智能",
        "Typecheck passes"
      ],
      "priority": 41,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-042",
      "title": "Boss 召唤小怪能力",
      "description": "作为 Boss，我需要召唤小怪，以便在战斗中增加难度。",
      "acceptanceCriteria": [
        "实现 Boss 召唤小怪功能",
        "召唤 3 只小怪（随机选择狼、熊、骷髅、僵尸）",
        "小怪作为独立的战斗单位",
        "Typecheck passes"
      ],
      "priority": 42,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-043",
      "title": "Boss 施法能力",
      "description": "作为 Boss，我需要施法，以便在战斗中造成更大的伤害。",
      "acceptanceCriteria": [
        "实现 Boss 施法功能",
        "施法类型：火焰风暴（对玩家造成大量伤害）、暗影诅咒（降低玩家防御）",
        "施法有冷却时间",
        "Typecheck passes"
      ],
      "priority": 43,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-044",
      "title": "地图数据结构定义",
      "description": "作为游戏引擎，我需要定义地图数据结构，以便存储和访问地图信息。",
      "acceptanceCriteria": [
        "定义地图对象：{ id, name, background, npcs [], monsters [], portals [] }",
        "定义 NPC 位置对象：{ npcId, x, y }",
        "定义怪物位置对象：{ monsterId, monsterType, x, y }",
        "定义传送点对象：{ portalId, targetMapId, x, y }",
        "导出类型定义供 TypeScript 使用",
        "Typecheck passes"
      ],
      "priority": 44,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-045",
      "title": "创建 7 张地图",
      "description": "作为游戏引擎，我需要创建 7 张地图，以便玩家可以在不同的地图中探索。",
      "acceptanceCriteria": [
        "创建村庄地图（village）",
        "创建森林地图（forest）",
        "创建山洞地图（cave）",
        "创建沙漠地图（desert）",
        "创建冰原地图（snow）",
        "创建火山地图（volcano）",
        "创建魔宫地图（demon_palace）",
        "每张地图包含 NPC、怪物、传送点",
        "Typecheck passes"
      ],
      "priority": 45,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-046",
      "title": "地图背景渲染",
      "description": "作为游戏前端，我需要渲染地图背景，以便玩家可以看到地图画面。",
      "acceptanceCriteria": [
        "使用 HTML5 Canvas 渲染地图背景",
        "背景图符合国风风格",
        "背景图尺寸 512x512",
        "每张地图有 4 张背景图（白天、夜晚、清晨、黄昏）",
        "背景图可以正常加载和显示",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 46,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-047",
      "title": "NPC 渲染",
      "description": "作为游戏前端，我需要渲染 NPC，以便玩家可以看到并点击 NPC。",
      "acceptanceCriteria": [
        "使用 HTML5 Canvas 渲染 NPC",
        "NPC 位置正确显示",
        "NPC 有独立的图片",
        "NPC 图片符合国风风格",
        "NPC 可以正常点击",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 47,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-048",
      "title": "怪物渲染",
      "description": "作为游戏前端，我需要渲染怪物，以便玩家可以看到并攻击怪物。",
      "acceptanceCriteria": [
        "使用 HTML5 Canvas 渲染怪物",
        "怪物位置正确显示",
        "怪物有独立的图片",
        "怪物图片符合国风风格",
        "怪物可以正常点击（开始战斗）",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 48,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-049",
      "title": "传送点渲染",
      "description": "作为游戏前端，我需要渲染传送点，以便玩家可以看到并点击传送点。",
      "acceptanceCriteria": [
        "使用 HTML5 Canvas 渲染传送点",
        "传送点位置正确显示",
        "传送点有独立的图标",
        "传送点图标清晰可见",
        "传送点可以正常点击（切换地图）",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 49,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-050",
      "title": "传送点点击检测",
      "description": "作为游戏前端，我需要检测玩家是否点击了传送点，以便切换地图。",
      "acceptanceCriteria": [
        "实现传送点点击检测函数",
        "函数检测玩家点击位置是否在传送点范围内",
        "函数返回点击的传送点信息",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 50,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-051",
      "title": "地图切换逻辑",
      "description": "作为游戏引擎，我需要实现地图切换逻辑，以便玩家可以在不同的地图之间移动。",
      "acceptanceCriteria": [
        "创建 switchMap() 函数",
        "函数接受参数：targetMapId",
        "函数更新 gameState 中的 currentMap",
        "函数更新玩家位置（设置为目标地图的初始位置）",
        "函数返回更新后的 gameState",
        "Typecheck passes"
      ],
      "priority": 51,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-052",
      "title": "玩家位置更新",
      "description": "作为游戏引擎，我需要更新玩家位置，以便玩家可以在地图中移动。",
      "acceptanceCriteria": [
        "创建 updatePlayerPosition() 函数",
        "函数接受参数：{ x, y }",
        "函数更新 gameState 中的玩家位置",
        "函数检查移动是否有效（边界检查）",
        "函数返回更新后的 gameState",
        "Typecheck passes"
      ],
      "priority": 52,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-053",
      "title": "地图背景生成",
      "description": "作为游戏引擎，我需要生成地图背景，以便玩家可以看到地图画面。",
      "acceptanceCriteria": [
        "使用 Qwen Image API 生成地图背景",
        "生成 7 张地图背景",
        "每张地图生成 4 张背景图（白天、夜晚、清晨、黄昏）",
        "背景图符合国风风格",
        "背景图尺寸 512x512",
        "背景图质量高",
        "背景图可以正常加载和显示",
        "Typecheck passes"
      ],
      "priority": 53,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-054",
      "title": "角色数据结构定义",
      "description": "作为游戏引擎，我需要定义角色数据结构，以便存储和访问角色信息。",
      "acceptanceCriteria": [
        "定义角色对象：{ id, name, class, level, exp, expToNextLevel, hp, maxHp, attack, defense, gold }",
        "导出类型定义供 TypeScript 使用",
        "添加类型注释和文档",
        "Typecheck passes"
      ],
      "priority": 54,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-055",
      "title": "角色创建界面 HTML",
      "description": "作为游戏前端，我需要创建角色创建界面的 HTML 结构，以便玩家可以创建角色。",
      "acceptanceCriteria": [
        "创建角色创建界面 HTML",
        "包含名字输入框",
        "包含职业选择（剑修、法修、体修）",
        "包含创建按钮",
        "HTML 结构完整",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 55,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-056",
      "title": "角色创建界面 CSS",
      "description": "作为游戏前端，我需要创建角色创建界面的 CSS 样式，以便界面美观。",
      "acceptanceCriteria": [
        "定义国风配色方案",
        "实现角色创建界面样式",
        "样式美观，符合国风风格",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 56,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-057",
      "title": "角色创建界面 JavaScript",
      "description": "作为游戏前端，我需要实现角色创建界面的 JavaScript 逻辑，以便玩家可以创建角色。",
      "acceptanceCriteria": [
        "实现名字输入验证（不能为空）",
        "实现职业选择逻辑",
        "实现创建按钮点击事件",
        "创建后通知协调 Agent 初始化游戏状态",
        "角色创建界面可以正常工作",
        "Typecheck passes",
        "Verify in browser using dev-browser skill"
      ],
      "priority": 57,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-058",
      "title": "升级条件检查",
      "description": "作为游戏引擎，我需要检查升级条件，以便确定玩家是否可以升级。",
      "acceptanceCriteria": [
        "创建 checkLevelUp() 函数",
        "函数接受参数：{ level, exp, expToNextLevel }",
        "函数检查 exp 是否 >= expToNextLevel",
        "函数返回是否可以升级",
        "Typecheck passes"
      ],
      "priority": 58,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-059",
      "title": "升级属性计算",
      "description": "作为游戏引擎，我需要计算升级属性，以便提升玩家能力。",
      "acceptanceCriteria": [
        "创建 calculateLevelUpStats() 函数",
        "函数接受参数：{ level, attack, defense, hp }",
        "函数计算升级后的属性",
        "升级获得 20 属性点",
        "函数返回升级后的属性",
        "Typecheck passes"
      ],
      "priority": 59,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-060",
      "title": "属性分配逻辑",
      "description": "作为游戏引擎，我需要实现属性分配逻辑，以便玩家可以自定义角色成长。",
      "acceptanceCriteria": [
        "创建 distributeStatPoints() 函数",
        "函数接受参数：{ statPoints, attackPoints, defensePoints, hpPoints }",
        "函数检查属性点是否足够",
        "函数更新角色属性",
        "函数返回更新后的角色属性",
        "Typecheck passes"
      ],
      "priority": 60,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-061",
      "title": "升级动画生成",
      "description": "作为游戏引擎，我需要生成升级动画，以便玩家可以看到升级效果。",
      "acceptanceCriteria": [
        "使用 Remotion 生成升级动画",
        "动画显示角色升级效果（光芒、等级提升）",
        "动画长度 3-5 秒",
        "动画可以正常播放",
        "Typecheck passes"
      ],
      "priority": 61,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-062",
      "title": "角色图片生成",
      "description": "作为游戏引擎，我需要生成角色图片，以便玩家可以看到角色形象。",
      "acceptanceCriteria": [
        "使用 Qwen Image API 生成角色图片",
        "生成 3 张角色图片（对应 3 个职业）",
        "每个角色生成 4 张动作图（站立、攻击、受伤、死亡）",
        "图片符合国风风格",
        "图片尺寸 512x512",
        "图片质量高",
        "图片可以正常加载和显示",
        "Typecheck passes"
      ],
      "priority": 62,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-063",
      "title": "技能数据结构定义",
      "description": "作为游戏引擎，我需要定义技能数据结构，以便存储和访问技能信息。",
      "acceptanceCriteria": [
        "定义技能对象：{ id, name, description, class, level, cooldown, effect { type, value } }",
        "导出类型定义供 TypeScript 使用",
        "添加类型注释和文档",
        "Typecheck passes"
      ],
      "priority": 63,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-064",
      "title": "创建 30 个技能",
      "description": "作为游戏引擎，我需要创建 30 个技能，以便玩家可以学习不同的技能。",
      "acceptanceCriteria": [
        "创建剑修技能（10 个）",
        "创建法修技能（10 个）",
        "创建体修技能（10 个）",
        "每个技能有明确的等级要求",
        "每个技能有明确的冷却时间",
        "每个技能有明确的技能效果",
        "Typecheck passes"
      ],
      "priority": 64,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-065",
      "title": "技能学习条件检查",
      "description": "作为游戏引擎，我需要检查技能学习条件，以便确定玩家是否可以学习技能。",
      "acceptanceCriteria": [
        "创建 checkSkillLearnCondition() 函数",
        "函数接受参数：{ playerLevel, skillId, skillPoints, gold }",
        "函数检查玩家等级是否满足技能要求",
        "函数检查技能点是否足够",
        "函数检查金币是否足够",
        "函数返回是否可以学习技能",
        "Typecheck passes"
      ],
      "priority": 65,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-066",
      "title": "技能消耗逻辑",
      "description": "作为游戏引擎，我需要实现技能消耗逻辑，以便扣除玩家消耗的资源。",
      "acceptanceCriteria": [
        "创建 deductSkillCost() 函数",
        "函数接受参数：{ skillId, playerGold, playerSkillPoints }",
        "函数扣除金币和技能点",
        "函数返回扣除后的金币和技能点",
        "Typecheck passes"
      ],
      "priority": 66,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-067",
      "title": "技能学习逻辑",
      "description": "作为游戏引擎，我需要实现技能学习逻辑，以便玩家可以学习新技能。",
      "acceptanceCriteria": [
        "创建 learnSkill() 函数",
        "函数接受参数：{ playerId, skillId }",
        "函数检查技能学习条件",
        "函数扣除技能消耗",
        "函数将技能添加到玩家的技能列表",
        "函数返回学习结果",
        "Typecheck passes"
      ],
      "priority": 67,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-068",
      "title": "技能释放逻辑",
      "description": "作为游戏引擎，我需要实现技能释放逻辑，以便玩家可以在战斗中使用技能。",
      "acceptanceCriteria": [
        "创建 castSkill() 函数",
        "函数接受参数：{ skillId, target }",
        "函数检查技能冷却时间",
        "函数计算技能效果",
        "函数应用技能效果",
        "函数返回技能释放结果",
        "Typecheck passes"
      ],
      "priority": 68,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-069",
      "title": "冷却时间管理",
      "description": "作为游戏引擎，我需要管理冷却时间，以便技能不能频繁释放。",
      "acceptanceCriteria": [
        "创建 cooldown 管理对象",
        "实现开始冷却函数（记录技能释放时间）",
        "实现检查冷却函数（检查技能是否在冷却中）",
        "实现重置冷却函数（重置所有技能冷却）",
        "Typecheck passes"
      ],
      "priority": 69,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-070",
      "title": "技能自动触发",
      "description": "作为游戏引擎，我需要实现技能自动触发，以便在战斗中自动使用技能。",
      "acceptanceCriteria": [
        "创建 autoCastSkill() 函数",
        "函数在战斗中定期调用",
        "函数检查是否有技能可以使用（不在冷却中）",
        "函数自动选择并释放技能",
        "函数返回技能释放结果",
        "Typecheck passes"
      ],
      "priority": 70,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-071",
      "title": "技能图片生成",
      "description": "作为游戏引擎，我需要生成技能图片，以便玩家可以看到技能图标。",
      "acceptanceCriteria": [
        "使用 Qwen Image API 生成技能图片",
        "生成 30 张技能图片（3 个职业 × 10 个技能）",
        "图片符合国风风格",
        "图片尺寸 512x512",
        "图片质量高",
        "图片可以正常加载和显示",
        "Typecheck passes"
      ],
      "priority": 71,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-072",
      "title": "通关条件检查",
      "description": "作为游戏引擎，我需要检查通关条件，以便确定玩家是否可以通关。",
      "acceptanceCriteria": [
        "创建 checkGameCompleteCondition() 函数",
        "函数接受参数：{ playerLevel, bossDefeated }",
        "函数检查玩家等级是否达到最高等级（10 级）",
        "函数检查 Boss 是否被击败",
        "函数返回是否可以通关",
        "Typecheck passes"
      ],
      "priority": 72,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-073",
      "title": "通关触发逻辑",
      "description": "作为游戏引擎，我需要实现通关触发逻辑，以便玩家可以通关游戏。",
      "acceptanceCriteria": [
        "创建 triggerGameComplete() 函数",
        "函数检查通关条件",
        "函数触发通关事件",
        "函数显示通关画面",
        "Typecheck passes"
      ],
      "priority": 73,
      "passes": false,
      "notes": ""
    },
    {
      "id": "US-074",
      "title": "结局画面生成",
      "description": "作为游戏引擎，我需要生成结局画面，以便玩家可以看到通关效果。",
      "acceptanceCriteria": [
        "使用 Remotion 生成结局画面",
        "画面显示通关动画",
        "画面显示结局文字",
        "画面符合国风风格",
        "画面可以正常播放",
        "Typecheck passes"
      ],
      "priority": 74,
      "passes": false,
      "notes": ""
    }
  ]
}
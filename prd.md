# PRD: 修仙游戏

## 功能概述

一个基于 HTML/JavaScript 的 2D 修仙游戏，玩家扮演主角，通过战斗、升级、装备、技能等方式提升实力，与 NPC 对话触发任务，完成任务获得奖励，探索多张地图，最终击败 Boss 成为仙人。

## 用户故事

### US1: 开始游戏
作为玩家，我想要点击"开始游戏"按钮，输入名字、选择职业，然后创建角色并进入游戏世界。

### US2: 角色升级
作为玩家，我想要击败怪物获得经验，升级后获得属性点和技能点，可以选择提升角色的攻击、防御、生命属性，并学习/升级技能。

### US3: 技能系统
作为玩家，我想要学习和升级技能，技能会自动释放，有冷却时间，可以提升战斗效率。

### US4: 战斗系统
作为玩家，我想要探索地图时自动遇到怪物，进入即时制战斗，可以选择攻击目标（点击怪物），战斗时有攻击动画和受伤特效。

### US5: 怪物系统
作为玩家，我想要在地图上遇到不同等级的怪物，击败怪物后获得金币、装备、技能书。

### US6: Boss 战
作为玩家，我想要挑战更强大的 Boss，击败 Boss 后获得稀有物品。

### US7: 地图探索
作为玩家，我想要通过传送阵/传送点自由切换到任意地图，探索不同的地图和怪物。

### US8: 商店系统
作为玩家，我想要在商店购买装备、道具、技能书，也可以出售物品获得金币。

### US9: 装备系统
作为玩家，我想要装备武器、防具、饰品来提升角色属性，装备可以升级到最高 10 级。

### US10: 存档系统
作为玩家，我想要手动保存游戏进度，随时加载存档继续游戏。

### US11: NPC 交互
作为玩家，我想要与 NPC 对话，了解剧情，触发任务，完成任务获得奖励。

### US12: 任务系统
作为玩家，我想要接受任务，完成任务，获得金币、经验、装备等奖励。

### US11: NPC 交互
作为玩家，我想要与 NPC 对话，了解剧情（线性剧情），触发任务，完成任务获得奖励。

### US12: 任务系统
作为玩家，我想要接受任务（击杀任务、收集任务、探索任务、对话任务），完成任务，获得金币、经验、装备、技能书等奖励。

### US13: 游戏通关
作为玩家，我想要达到最高等级，击败最终 Boss，成为仙人，看到结局画面。

## 使用场景

### 场景 1: 游戏开始
1. 玩家打开游戏，看到"开始游戏"按钮
2. 玩家点击按钮，进入角色创建界面
3. 玩家输入名字，选择职业（剑修、法修、体修）
4. 玩家点击"确认创建"，进入游戏世界
5. 主角显示在地图中央，属性面板显示主角的等级、生命、攻击、防御等

### 场景 2: 探索并遇到怪物
1. 玩家在地图上探索
2. 系统自动生成怪物（狼、熊、骷髅、僵尸等）
3. 怪物显示在地图上，玩家可以看到怪物的名称、等级、属性
4. 玩家点击怪物，进入战斗

### 场景 3: 战斗
1. 进入战斗界面，主角和怪物面对面
2. 战斗自动进行，主角和怪物互相攻击
3. 玩家可以点击怪物选择攻击目标（多个怪物时）
4. 技能自动释放，有冷却时间
5. 攻击有动画效果，受伤有视觉反馈
6. 战斗日志实时更新
7. 主角死亡（生命值归零）→ 战败，可以重生或加载存档
8. 怪物死亡 → 胜利，获得金币、装备、技能书

### 场景 4: 升级
1. 玩家击败怪物，获得经验
2. 经验值达到升级阈值，角色升级
3. 升级时有动画效果（如闪光、粒子）
4. 恢复生命值
5. 获得 20 属性点和 5 技能点
6. 弹出对话框，选择提升哪些属性（攻击、防御、生命）
7. 可以学习/升级技能（消耗金币和技能点）

### 场景 5: 地图切换
1. 玩家走到传送阵/传送点
2. 点击传送阵/传送点
3. 弹出地图列表，选择目标地图
4. 传送到目标地图
5. 地图背景显示，主角显示在传送阵/传送点附近

### 场景 6: 商店购物
1. 玩家走到商店
2. 点击商店，进入商店界面
3. 可以购买装备（武器、防具、饰品）
4. 可以购买道具（药水、材料等）
5. 可以购买技能书
6. 可以出售物品给商店，获得金币

### 场景 7: 装备升级
1. 玩家打开装备界面
2. 选择要升级的装备
3. 点击"升级"按钮
4. 消耗金币，升级成功（100% 成功率）
5. 装备属性提升
6. 装备最高可升级到 +10 级

### 场景 8: 存档和加载
1. 玩家点击"保存游戏"按钮
2. 游戏进度保存到浏览器本地存储
3. 玩家可以点击"加载游戏"按钮
4. 加载之前的存档，继续游戏

### 场景 9: NPC 交互
1. 玩家在地图上看到 NPC（4-6 个 NPC）
2. 玩家点击 NPC
3. 弹出对话框，显示 NPC 的对话
4. 对话中包含剧情信息（线性剧情，按顺序了解剧情）
5. 对话中可能触发任务
6. NPC 可以出售物品（装备、道具、技能书等）

### 场景 10: 任务系统
1. 玩家接受任务（与 NPC 对话触发）
2. 任务类型：击杀任务（比如击败 5 只狼）、收集任务（比如收集 3 根狼毛）、探索任务（比如到达某个地点）、对话任务（比如与某个 NPC 对话）
3. 任务难度：简单（比如击败 5 只狼）、中等（比如击败 5 只熊）、困难（比如击败 Boss）
4. 任务列表显示当前任务
5. 任务有进度（比如"击败 5 只狼 0/5"）
6. 任务进度实时更新
7. 玩家完成任务
8. 玩家返回 NPC，提交任务
9. 获得奖励（金币、经验、装备、技能书等）
10. 任务完成

### 场景 11: 游戏通关
1. 玩家达到最高等级
2. 挑战最终 Boss
3. 击败最终 Boss
4. 显示结局画面
5. 游戏通关

## 技术要求

### 前端技术栈
- HTML5 Canvas 用于渲染
- JavaScript 用于游戏逻辑
- CSS 用于 UI 样式

### 后端技术栈
- 无后端（单页面应用）
- 使用浏览器本地存储（localStorage）存档

### AI 图片生成
- 使用 Qwen Image API 生成图片
- 人物形象：主角（剑修、法修、体修）、NPC 等
- 地图背景：每张地图的背景图
- 怪物形象：狼、熊、骷髅、僵尸、Boss 等
- 物品形象：装备（武器、防具、饰品）、道具、技能书等

## 视觉要求

### 图片风格
- 国风风格（中国古典风格，适合修仙题材）
- 图片分辨率：512x512（大尺寸）

### 人物
- 主角（剑修、法修、体修）：每个角色 4 张图（站立、攻击、受伤等动作）
- NPC：每个 NPC 4 张图（站立、说话、动作等）
- NPC 有头标/标记，方便识别
- 所有人物图片都是国风风格

### 地图
- 每张地图有 4 张背景图（比如：白天、夜晚、清晨、黄昏）
- 地图背景要符合修仙主题（森林、山脉、洞穴、宫殿等）
- 不是纯色背景

### 怪物
- 每种怪物 4 张图（站立、攻击、受伤等动作）
- 狼、熊、骷髅、僵尸、Boss 等
- 所有怪物图片都是国风风格

### 物品
- 装备（武器、防具、饰品）：每个装备 4 张图（不同品质/稀有度的不同外观）
- 道具（药水、材料等）：每个道具 4 张图（不同状态/效果）
- 技能书：每个技能书 4 张图（不同等级/类型）
- 所有物品图片都是国风风格

### 动画
- 角色移动有动画
- 攻击有动画效果
- 受伤有视觉反馈
- 升级有动画效果（如闪光、粒子）

### UI
- 精美 UI 样式，渐变背景
- 属性面板实时更新
- 战斗日志实时更新
- 按钮有点击反馈

## 验收标准

### 角色创建系统
- ✅ 角色创建界面正常显示
- ✅ 可以输入名字
- ✅ 可以选择职业（剑修、法修、体修）
- ✅ 角色有独立的图片（不是圆圈）
- ✅ 角色图片是国风风格，分辨率 512x512
- ✅ 每个角色 4 张图（站立、攻击、受伤等动作）
- ✅ 创建后进入游戏世界

### 角色系统
- ✅ 主角有独立的图片，显示在地图中央
- ✅ 主角图片是国风风格，分辨率 512x512
- ✅ 主角 4 张图（站立、攻击、受伤等动作）
- ✅ 属性面板显示主角的等级、生命、攻击、防御等
- ✅ 属性面板实时更新
- ✅ 升级时属性正确计算
- ✅ 升级时有动画效果
- ✅ 可以选择提升哪些属性（攻击、防御、生命）

### 技能系统
- ✅ 技能自动释放
- ✅ 技能有冷却时间
- ✅ 技能需要学习（有等级要求）
- ✅ 可以升级技能
- ✅ 消耗金币和技能点
- ✅ 每个职业 10 个技能

### 战斗系统
- ✅ 战斗逻辑正确（即时制）
- ✅ 攻击有动画效果
- ✅ 受伤有视觉反馈
- ✅ 战斗日志实时更新
- ✅ 主角死亡（生命值归零）→ 战败
- ✅ 怪物死亡 → 胜利
- ✅ 可以选择攻击目标（点击怪物）

### 怪物系统
- ✅ 每种怪物有独立的图片（不是圆圈）
- ✅ 怪物图片是国风风格，分辨率 512x512
- ✅ 每种怪物 4 张图（站立、攻击、受伤等动作）
- ✅ 怪物属性正确显示（名称、等级、生命、攻击、防御）
- ✅ 怪物有等级差异
- ✅ 击败怪物后获得金币、装备、技能书

### 地图系统
- ✅ 多张地图（7 张以上）
- ✅ 每张地图有背景图，不是纯色背景
- ✅ 地图背景是国风风格，分辨率 512x512
- ✅ 每张地图 4 张背景图（比如：白天、夜晚、清晨、黄昏）
- ✅ 可以通过传送阵/传送点自由切换
- ✅ 点击传送阵/传送点 → 选择目标地图 → 传送

### 商店系统
- ✅ 每张地图都有商店
- ✅ 可以购买装备、道具、技能书
- ✅ 可以出售物品获得金币

### 装备系统
- ✅ 装备类型：武器、防具、饰品
- ✅ 装备有品质/稀有度
- ✅ 装备有独立的图片
- ✅ 装备图片是国风风格，分辨率 512x512
- ✅ 每个装备 4 张图（不同品质/稀有度的不同外观）
- ✅ 可以装备和卸下装备
- ✅ 装备提升角色属性
- ✅ 可以升级装备（消耗金币）
- ✅ 装备升级 100% 成功
- ✅ 装备最高可升级到 +10 级

### NPC 系统
- ✅ NPC 有独立的图片，不是圆圈
- ✅ NPC 图片是国风风格，分辨率 512x512
- ✅ 每个 NPC 4 张图（站立、说话、动作等）
- ✅ NPC 显示在地图上
- ✅ NPC 有头标/标记，方便识别
- ✅ 点击 NPC 可以打开对话框
- ✅ 对话内容正常显示
- ✅ 对话可以包含剧情信息（线性剧情，按顺序了解剧情）
- ✅ 对话可以触发任务
- ✅ NPC 可以出售物品（装备、道具、技能书等）

### 任务系统
- ✅ 可以接受任务（与 NPC 对话触发）
- ✅ 任务类型：击杀任务、收集任务、探索任务、对话任务
- ✅ 任务难度：简单、中等、困难
- ✅ 任务列表显示当前任务
- ✅ 任务有进度（比如"击败 5 只狼 0/5"）
- ✅ 任务进度实时更新
- ✅ 可以提交任务（返回 NPC）
- ✅ 任务完成后获得奖励（金币、经验、装备、技能书等）

### 存档系统
- ✅ 可以手动保存游戏进度
- ✅ 保存到浏览器本地存储
- ✅ 可以加载存档
- ✅ 存档数据正确（角色、装备、金币、技能等）

### 游戏通关
- ✅ 达到最高等级
- ✅ 挑战最终 Boss
- ✅ 击败最终 Boss
- ✅ 显示结局画面

## 非功能性需求

### 性能
- 游戏流畅，没有卡顿
- 响应时间 < 100ms
- 支持主流浏览器

### 图片生成系统
- ✅ 图片是国风风格（中国古典风格，适合修仙题材）
- ✅ 图片分辨率是 512x512
- ✅ 每个角色有 4 张图（站立、攻击、受伤等动作）
- ✅ 每个 NPC 有 4 张图（站立、说话、动作等）
- ✅ 每种怪物有 4 张图（站立、攻击、受伤等动作）
- ✅ 每张地图有 4 张背景图（白天、夜晚、清晨、黄昏）
- ✅ 每个装备有 4 张图（不同品质/稀有度的不同外观）
- ✅ 每个道具有 4 张图（不同状态/效果）
- ✅ 每个技能书有 4 张图（不同等级/类型）
- ✅ 使用 Qwen Image API 生成图片

### 可用性
- 界面友好，容易理解
- 操作流畅，没有延迟
- 有操作提示

### 可维护性
- 代码结构清晰
- 易于扩展（添加新的怪物、地图、装备等）

## 限制

### 时间限制
- 开发时间：2 周

### 技术限制
- 单页面应用（SPA）
- 本地存储用于存档
- 无后端服务器

### 资源限制
- 使用 AI 生成图片（Qwen Image API）
